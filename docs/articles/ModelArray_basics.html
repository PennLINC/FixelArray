<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ModelArray">
<title>ModelArray Quick Start • ModelArray</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ModelArray Quick Start">
<meta property="og:description" content="ModelArray">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ModelArray</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ModelArray_basics.html">ModelArray Quick Start</a>
    <a class="dropdown-item" href="../articles/basic_r_intro.html">An intro to R</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ModelArray Quick Start</h1>
            
      
      
      <div class="d-none name"><code>ModelArray_basics.Rmd</code></div>
    </div>

    
    
<p>Here we will use some example data to show you the basic use of <code>ModelArray</code>.</p>
<div class="section level2">
<h2 id="concepts-and-goals">Concepts and Goals<a class="anchor" aria-label="anchor" href="#concepts-and-goals"></a>
</h2>
<div class="section level3">
<h3 id="goals">Goals<a class="anchor" aria-label="anchor" href="#goals"></a>
</h3>
<p>ModelArray is a generalizable, memory-efficient R package for statistical analysis of fixel data. Its features include:</p>
<ul>
<li>Easy to use: set up your analysis with just several lines of codes;</li>
<li>Low memory requirement, even for large datasets;</li>
<li>At present, ModelArray supports linear models as well as generalized additive models (GAM) with penalized splines, which are particularly useful for studying nonlinear effects in lifespan data.</li>
</ul>
</div>
<div class="section level3">
<h3 id="elements">Elements<a class="anchor" aria-label="anchor" href="#elements"></a>
</h3>
<p>In this package, “element” is a general name for one point of data; it could be voxel in 3D images, vertex in surface data, or fixel in fixel-based analysis. There should be scalar value associated with each element. And with some demographics or other phenotype data, we can model the scalar value with independent variables and covariates. We treat each element equally.</p>
</div>
</div>
<div class="section level2">
<h2 id="quick-start-fixel-wise-statistical-analysis">Quick start: fixel-wise statistical analysis<a class="anchor" aria-label="anchor" href="#quick-start-fixel-wise-statistical-analysis"></a>
</h2>
<div class="section level3">
<h3 id="load-modelarray-package">Load <code>ModelArray</code> package<a class="anchor" aria-label="anchor" href="#load-modelarray-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pennlinc.github.io/ModelArray">ModelArray</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data-using-modelarray">Load data using <code>ModelArray()</code><a class="anchor" aria-label="anchor" href="#load-data-using-modelarray"></a>
</h3>
<p>We provide example .h5 data in “inst/extdata”. Example data is fixel-wise data generated by ConFixel python package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># file of example .h5, fixel-wise data</span>
<span class="va">h5_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"n50_fixels.h5"</span>, package <span class="op">=</span> <span class="st">"ModelArray"</span><span class="op">)</span>
<span class="va">modelarray</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.html">ModelArray</a></span><span class="op">(</span><span class="va">h5_path</span>, 
                               scalar_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FD"</span><span class="op">)</span><span class="op">)</span>  <span class="co"># if there is more than one metric, you can do: c("FD", "FDC")</span>
<span class="va">modelarray</span> <span class="co"># check what's in it    </span>
<span class="co">#&gt; ModelArray located at /tmp/RtmpUQ59aH/temp_libpathbeb665cba640/ModelArray/extdata/n50_fixels.h5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Source files:     50</span>
<span class="co">#&gt;   Scalars:          FD</span>
<span class="co">#&gt;   Analyses:</span></code></pre></div>
<p>This shows that there are 50 source files, with scalars of FD in this <code>modelarray</code> you loaded.</p>
</div>
<div class="section level3">
<h3 id="accessors-of-modelarray">Accessors of ModelArray<a class="anchor" aria-label="anchor" href="#accessors-of-modelarray"></a>
</h3>
<p>To access ModelArray’s slots:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">scalars</span><span class="op">(</span><span class="va">modelarray</span><span class="op">)</span><span class="op">[[</span><span class="st">"FD"</span><span class="op">]</span><span class="op">]</span>   <span class="co"># FD data</span>
<span class="co">#&gt; &lt;182581 x 50&gt; matrix of class DelayedMatrix and type "double":</span>
<span class="co">#&gt;            FD/sub1_fd.mif  FD/sub2_fd.mif ... FD/sub49_fd.mif FD/sub50_fd.mif</span>
<span class="co">#&gt;      [1,]      36.0214119      81.9753342   .        37.82116       237.40558</span>
<span class="co">#&gt;      [2,]    1046.6225586    1058.1074219   .      1085.59241       986.08856</span>
<span class="co">#&gt;      [3,]       0.2467898      83.6336441   .        20.79962       108.81217</span>
<span class="co">#&gt;      [4,]       0.6753999      72.3661575   .        13.40481       120.06551</span>
<span class="co">#&gt;      [5,]       0.2290502       1.7837602   .       132.53795        15.16265</span>
<span class="co">#&gt;       ...               .               .   .               .               .</span>
<span class="co">#&gt; [182577,]      0.02690634     14.75695896   .       31.983732      150.156906</span>
<span class="co">#&gt; [182578,]      0.04722600     23.99450111   .       27.997149       83.266426</span>
<span class="co">#&gt; [182579,]      0.11819888     43.39178085   .       61.914310       99.171700</span>
<span class="co">#&gt; [182580,]     32.06180573     11.31695938   .       13.557989        3.398834</span>
<span class="co">#&gt; [182581,]      9.01556969     12.15083504   .       35.347015       21.815554</span>
<span class="fu">sources</span><span class="op">(</span><span class="va">modelarray</span><span class="op">)</span><span class="op">[[</span><span class="st">"FD"</span><span class="op">]</span><span class="op">]</span>  <span class="co"># list of source filenames for FD data</span>
<span class="co">#&gt;  [1] "FD/sub1_fd.mif"  "FD/sub2_fd.mif"  "FD/sub3_fd.mif"  "FD/sub4_fd.mif" </span>
<span class="co">#&gt;  [5] "FD/sub5_fd.mif"  "FD/sub6_fd.mif"  "FD/sub7_fd.mif"  "FD/sub8_fd.mif" </span>
<span class="co">#&gt;  [9] "FD/sub9_fd.mif"  "FD/sub10_fd.mif" "FD/sub11_fd.mif" "FD/sub12_fd.mif"</span>
<span class="co">#&gt; [13] "FD/sub13_fd.mif" "FD/sub14_fd.mif" "FD/sub15_fd.mif" "FD/sub16_fd.mif"</span>
<span class="co">#&gt; [17] "FD/sub17_fd.mif" "FD/sub18_fd.mif" "FD/sub19_fd.mif" "FD/sub20_fd.mif"</span>
<span class="co">#&gt; [21] "FD/sub21_fd.mif" "FD/sub22_fd.mif" "FD/sub23_fd.mif" "FD/sub24_fd.mif"</span>
<span class="co">#&gt; [25] "FD/sub25_fd.mif" "FD/sub26_fd.mif" "FD/sub27_fd.mif" "FD/sub28_fd.mif"</span>
<span class="co">#&gt; [29] "FD/sub29_fd.mif" "FD/sub30_fd.mif" "FD/sub31_fd.mif" "FD/sub32_fd.mif"</span>
<span class="co">#&gt; [33] "FD/sub33_fd.mif" "FD/sub34_fd.mif" "FD/sub35_fd.mif" "FD/sub36_fd.mif"</span>
<span class="co">#&gt; [37] "FD/sub37_fd.mif" "FD/sub38_fd.mif" "FD/sub39_fd.mif" "FD/sub40_fd.mif"</span>
<span class="co">#&gt; [41] "FD/sub41_fd.mif" "FD/sub42_fd.mif" "FD/sub43_fd.mif" "FD/sub44_fd.mif"</span>
<span class="co">#&gt; [45] "FD/sub45_fd.mif" "FD/sub46_fd.mif" "FD/sub47_fd.mif" "FD/sub48_fd.mif"</span>
<span class="co">#&gt; [49] "FD/sub49_fd.mif" "FD/sub50_fd.mif"</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="preparation-for-statistical-analysis">Preparation for statistical analysis<a class="anchor" aria-label="anchor" href="#preparation-for-statistical-analysis"></a>
</h3>
<p>To perform statistical analysis, please provide a .csv file with subjects’ demographic or phenotype data you are interested in, and these data will be used as independent variables or coviariates in the model. The easiest way is simply use the cohort .csv you prepared for ConFixel, and add necessary demographic or phenotype data as additional column if needed.<br></p>
<p>The requirement of this .csv: There must be a column of “source_file”, providing the filename of the source image file. This requirement is consistent with that in ConFixel. The purpose is to have a sanity (or consistency) check between orders in .h5 file and .csv file.<br></p>
<p><code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code>, <code><a href="../reference/ModelArray.gam.html">ModelArray.gam()</a></code> etc functions can flexibly handle that only the order was changed: as long as source file lists from <code>phenotypes</code> and <code>modelarray</code> can be matched (either with or without changing the order in <code>phenotypes</code>), our functions will do the matching and find the correct rows in <code>phenotypes</code>. However if they cannot be matched, an error will be thrown out.</p>
<p>Example would be: ++++ TODO: add a table!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">csv_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"n50_cohort.csv"</span>, package <span class="op">=</span> <span class="st">"ModelArray"</span><span class="op">)</span>  <span class="co"># </span>
<span class="va">phenotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">csv_path</span><span class="op">)</span>   
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">phenotypes</span><span class="op">)</span>
<span class="co">#&gt;   subject_id      age sex scalar_name    source_file  factorA     factorB</span>
<span class="co">#&gt; 1       sub1 22.88783   F          FD FD/sub1_fd.mif 22.16587  0.87416816</span>
<span class="co">#&gt; 2       sub2 18.88235   M          FD FD/sub2_fd.mif 19.16176 -1.66829817</span>
<span class="co">#&gt; 3       sub3 23.85117   F          FD FD/sub3_fd.mif 22.88838 -0.24118500</span>
<span class="co">#&gt; 4       sub4 25.41304   M          FD FD/sub4_fd.mif 24.05978 -0.09271979</span>
<span class="co">#&gt; 5       sub5 16.74746   F          FD FD/sub5_fd.mif 17.56059 -0.69380591</span>
<span class="co">#&gt; 6       sub6 23.77783   M          FD FD/sub6_fd.mif 22.83337 -0.86222583</span></code></pre></div>
<p>If needed, you can manipulate data.frame “phenotypes” (e.g. demean, add new column, etc) via R packages “dplyr”. See <a href="https://pennlinc.github.io/ModelArray/articles/basic_r_intro.html">R: an intro</a>.</p>
</div>
<div class="section level3">
<h3 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h3>
<p>Now, let’s perform linear regression metric FD (y) over subject’s age, using <code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">FD</span> <span class="op">~</span> <span class="va">age</span>
<span class="va">mylm_fullOutputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.lm.html">ModelArray.lm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">modelarray</span>, <span class="va">phenotypes</span>, <span class="st">"FD"</span>,  <span class="co"># dependent variable</span>
                      element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  <span class="co"># let's check out first 100 fixels</span>
                      full.outputs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># let's first view all statistics</span>
                      <span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">subset: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">weights: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">na.action: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">model: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">x: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">y: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">qr: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">singular.ok: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">contrasts: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">offset: default</span></span>
<span class="co">#&gt; Fitting element-wise linear models for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mylm_fullOutputs</span><span class="op">)</span>
<span class="co">#&gt;   element_id Intercept.estimate age.estimate Intercept.std.error age.std.error</span>
<span class="co">#&gt; 1          0          163.59704   -3.5529524            61.46826      2.834597</span>
<span class="co">#&gt; 2          1         1006.39639    1.9317271            90.07811      4.153935</span>
<span class="co">#&gt; 3          2          167.42774   -4.5542156            68.43827      3.156018</span>
<span class="co">#&gt; 4          3           52.28663    0.7978552            52.78984      2.434393</span>
<span class="co">#&gt; 5          4          177.63929   -4.4614559            57.91336      2.670664</span>
<span class="co">#&gt; 6          5         1086.78063   -0.2157015            84.56369      3.899639</span>
<span class="co">#&gt;   Intercept.statistic age.statistic Intercept.p.value age.p.value</span>
<span class="co">#&gt; 1           2.6614879    -1.2534240      1.055048e-02   0.2161225</span>
<span class="co">#&gt; 2          11.1724856     0.4650354      5.938761e-15   0.6440089</span>
<span class="co">#&gt; 3           2.4464053    -1.4430259      1.814295e-02   0.1555078</span>
<span class="co">#&gt; 4           0.9904678     0.3277429      3.269124e-01   0.7445313</span>
<span class="co">#&gt; 5           3.0673281    -1.6705419      3.543869e-03   0.1013212</span>
<span class="co">#&gt; 6          12.8516222    -0.0553132      3.737785e-17   0.9561185</span>
<span class="co">#&gt;   model.r.squared model.adj.r.squared model.sigma model.statistic model.p.value</span>
<span class="co">#&gt; 1    3.169332e-02          0.01152026    60.99555      1.57107176     0.2161225</span>
<span class="co">#&gt; 2    4.485167e-03         -0.01625473    89.38539      0.21625797     0.6440089</span>
<span class="co">#&gt; 3    4.157802e-02          0.02161090    67.91196      2.08232389     0.1555078</span>
<span class="co">#&gt; 4    2.232825e-03         -0.01855399    52.38387      0.10741542     0.7445313</span>
<span class="co">#&gt; 5    5.494529e-02          0.03525665    57.46799      2.79071018     0.1013212</span>
<span class="co">#&gt; 6    6.373655e-05         -0.02076827    83.91337      0.00305955     0.9561185</span>
<span class="co">#&gt;   model.df model.logLik model.AIC model.BIC model.deviance model.df.residual</span>
<span class="co">#&gt; 1        1    -275.4664  556.9329  562.6689       178582.0                48</span>
<span class="co">#&gt; 2        1    -294.5742  595.1485  600.8845       383507.9                48</span>
<span class="co">#&gt; 3        1    -280.8370  567.6740  573.4100       221377.6                48</span>
<span class="co">#&gt; 4        1    -267.8563  541.7126  547.4487       131715.4                48</span>
<span class="co">#&gt; 5        1    -272.4878  550.9756  556.7116       158523.4                48</span>
<span class="co">#&gt; 6        1    -291.4156  588.8313  594.5673       337989.8                48</span>
<span class="co">#&gt;   model.nobs</span>
<span class="co">#&gt; 1         50</span>
<span class="co">#&gt; 2         50</span>
<span class="co">#&gt; 3         50</span>
<span class="co">#&gt; 4         50</span>
<span class="co">#&gt; 5         50</span>
<span class="co">#&gt; 6         50</span></code></pre></div>
<p>If all statistics are too many for you, try out default list of statistics:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mylm_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.lm.html">ModelArray.lm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">modelarray</span>, <span class="va">phenotypes</span>, <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  
                      n_cores <span class="op">=</span> <span class="fl">2</span>,  <span class="co"># running on 2 CPU cores for speeding up</span>
                      <span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">subset: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">weights: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">na.action: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">model: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">x: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">y: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">qr: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">singular.ok: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">contrasts: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">offset: default</span></span>
<span class="co">#&gt; Fitting element-wise linear models for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mylm_default</span><span class="op">)</span>
<span class="co">#&gt;   element_id Intercept.estimate age.estimate Intercept.statistic age.statistic</span>
<span class="co">#&gt; 1          0          163.59704   -3.5529524           2.6614879    -1.2534240</span>
<span class="co">#&gt; 2          1         1006.39639    1.9317271          11.1724856     0.4650354</span>
<span class="co">#&gt; 3          2          167.42774   -4.5542156           2.4464053    -1.4430259</span>
<span class="co">#&gt; 4          3           52.28663    0.7978552           0.9904678     0.3277429</span>
<span class="co">#&gt; 5          4          177.63929   -4.4614559           3.0673281    -1.6705419</span>
<span class="co">#&gt; 6          5         1086.78063   -0.2157015          12.8516222    -0.0553132</span>
<span class="co">#&gt;   Intercept.p.value age.p.value model.adj.r.squared model.p.value</span>
<span class="co">#&gt; 1      1.055048e-02   0.2161225          0.01152026     0.2161225</span>
<span class="co">#&gt; 2      5.938761e-15   0.6440089         -0.01625473     0.6440089</span>
<span class="co">#&gt; 3      1.814295e-02   0.1555078          0.02161090     0.1555078</span>
<span class="co">#&gt; 4      3.269124e-01   0.7445313         -0.01855399     0.7445313</span>
<span class="co">#&gt; 5      3.543869e-03   0.1013212          0.03525665     0.1013212</span>
<span class="co">#&gt; 6      3.737785e-17   0.9561185         -0.02076827     0.9561185</span></code></pre></div>
<p>You may be specifically interested in several statistics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mylm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.lm.html">ModelArray.lm</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">modelarray</span>, <span class="va">phenotypes</span>, <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, 
                      var.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimate"</span>, <span class="st">"p.value"</span><span class="op">)</span>, <span class="co"># statistics for terms such as intercept, age</span>
                      var.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r.squared"</span>, <span class="st">"p.value"</span>, <span class="st">"AIC"</span><span class="op">)</span>,    <span class="co"># statistics for the model</span>
                      correct.p.value.terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fdr"</span>,<span class="st">"bonferroni"</span><span class="op">)</span>,   <span class="co"># p value corrections for terms (i.e. age and intercept in our case)</span>
                      correct.p.value.model <span class="op">=</span> <span class="st">"fdr"</span>,  <span class="co"># p value corrections for linear model</span>
                      n_cores <span class="op">=</span> <span class="fl">2</span>,
<span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">subset: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">weights: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">na.action: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">model: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">x: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">y: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">qr: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">singular.ok: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">contrasts: default</span> </span>
<span class="co">#&gt; <span style="color: #000000;">offset: default</span></span>
<span class="co">#&gt; Fitting element-wise linear models for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mylm</span><span class="op">)</span>
<span class="co">#&gt;   element_id Intercept.estimate age.estimate Intercept.p.value</span>
<span class="co">#&gt; 1          0          163.59704   -3.5529524      1.055048e-02</span>
<span class="co">#&gt; 2          1         1006.39639    1.9317271      5.938761e-15</span>
<span class="co">#&gt; 3          2          167.42774   -4.5542156      1.814295e-02</span>
<span class="co">#&gt; 4          3           52.28663    0.7978552      3.269124e-01</span>
<span class="co">#&gt; 5          4          177.63929   -4.4614559      3.543869e-03</span>
<span class="co">#&gt; 6          5         1086.78063   -0.2157015      3.737785e-17</span>
<span class="co">#&gt;   Intercept.p.value.bonferroni Intercept.p.value.fdr age.p.value</span>
<span class="co">#&gt; 1                 1.000000e+00          4.396032e-02   0.2161225</span>
<span class="co">#&gt; 2                 5.938761e-13          1.484690e-13   0.6440089</span>
<span class="co">#&gt; 3                 1.000000e+00          6.479626e-02   0.1555078</span>
<span class="co">#&gt; 4                 1.000000e+00          4.301479e-01   0.7445313</span>
<span class="co">#&gt; 5                 3.543869e-01          1.968816e-02   0.1013212</span>
<span class="co">#&gt; 6                 3.737785e-15          1.868892e-15   0.9561185</span>
<span class="co">#&gt;   age.p.value.bonferroni age.p.value.fdr model.r.squared model.p.value</span>
<span class="co">#&gt; 1                      1       0.8727231    3.169332e-02     0.2161225</span>
<span class="co">#&gt; 2                      1       0.9612073    4.485167e-03     0.6440089</span>
<span class="co">#&gt; 3                      1       0.8727231    4.157802e-02     0.1555078</span>
<span class="co">#&gt; 4                      1       0.9756312    2.232825e-03     0.7445313</span>
<span class="co">#&gt; 5                      1       0.8727231    5.494529e-02     0.1013212</span>
<span class="co">#&gt; 6                      1       0.9756312    6.373655e-05     0.9561185</span>
<span class="co">#&gt;   model.p.value.fdr model.AIC</span>
<span class="co">#&gt; 1         0.8727231  556.9329</span>
<span class="co">#&gt; 2         0.9612073  595.1485</span>
<span class="co">#&gt; 3         0.8727231  567.6740</span>
<span class="co">#&gt; 4         0.9756312  541.7126</span>
<span class="co">#&gt; 5         0.8727231  550.9756</span>
<span class="co">#&gt; 6         0.9756312  588.8313</span></code></pre></div>
<p>For list of all possible p value correction method, see <code>p.adjust.methods</code> (except “none”).</p>
<p>To run across all fixels, simply use default setting that <code>element.subset = NULL</code>.</p>
</div>
<div class="section level3">
<h3 id="gam---generalized-additive-model">GAM - Generalized additive model<a class="anchor" aria-label="anchor" href="#gam---generalized-additive-model"></a>
</h3>
<p>Modelling age effect with GAM is often useful for developing population because of GAM’s flexibility. Running <code><a href="../reference/ModelArray.gam.html">ModelArray.gam()</a></code> is similar to <code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">FD</span> <span class="op">~</span> <span class="fu">s</span><span class="op">(</span><span class="va">age</span>, k<span class="op">=</span><span class="fl">4</span>, fx<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="va">sex</span>  <span class="co"># we add sex as a covariate</span>
<span class="va">mygam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.gam.html">ModelArray.gam</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">modelarray</span>, phenotypes <span class="op">=</span> <span class="va">phenotypes</span>, scalar <span class="op">=</span> <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
                        n_cores <span class="op">=</span> <span class="fl">2</span>, pbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">The formula requested: FD ~ s(age, k = 4, fx = TRUE) + sex</span> </span>
<span class="co">#&gt; <span style="color: #000000;">s(age):   k = 4;   fx = TRUE;   bs = tp (default)</span></span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span></span>
<span class="co">#&gt; Fitting element-wise GAMs for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mygam</span><span class="op">)</span>
<span class="co">#&gt;   element_id s_age.statistic s_age.p.value Intercept.estimate sexM.estimate</span>
<span class="co">#&gt; 1          0       1.2306636    0.30963383           68.99361     36.640118</span>
<span class="co">#&gt; 2          1       2.2871191    0.09143477         1065.70220    -35.661635</span>
<span class="co">#&gt; 3          2       1.1269130    0.34827816           74.01208     -8.730507</span>
<span class="co">#&gt; 4          3       0.8239727    0.48756050           62.10926     14.615306</span>
<span class="co">#&gt; 5          4       2.1823941    0.10321419           89.36170    -15.023467</span>
<span class="co">#&gt; 6          5       1.9297905    0.13831264         1086.74460     -9.190355</span>
<span class="co">#&gt;   Intercept.statistic sexM.statistic Intercept.p.value sexM.p.value</span>
<span class="co">#&gt; 1            5.726418      2.1235803      7.940891e-07   0.03923706</span>
<span class="co">#&gt; 2           61.504732     -1.4371812      4.531281e-45   0.15758379</span>
<span class="co">#&gt; 3            5.292183     -0.4359225      3.457228e-06   0.66497706</span>
<span class="co">#&gt; 4            5.870646      0.9646617      4.856860e-07   0.33986996</span>
<span class="co">#&gt; 5            7.777202     -0.9130189      7.287228e-10   0.36609851</span>
<span class="co">#&gt; 6           66.163570     -0.3907161      1.756068e-46   0.69785074</span>
<span class="co">#&gt;   model.dev.expl</span>
<span class="co">#&gt; 1     0.13701296</span>
<span class="co">#&gt; 2     0.14551292</span>
<span class="co">#&gt; 3     0.07159834</span>
<span class="co">#&gt; 4     0.07036785</span>
<span class="co">#&gt; 5     0.13702724</span>
<span class="co">#&gt; 6     0.12488886</span></code></pre></div>
<p>You can also set <code>full.outputs=TRUE</code> to request all statistics (except p.value corrections or effect size - see below for more).</p>
<p>Or you can specify the specific statistic terms you are interested in by assigning the values of <code>var.smoothTerms</code>, <code>var.parametricTerms</code>, and <code>var.model</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mygam_specific</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.gam.html">ModelArray.gam</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">modelarray</span>, phenotypes <span class="op">=</span> <span class="va">phenotypes</span>, scalar <span class="op">=</span> <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
                          var.smoothTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.value"</span><span class="op">)</span>,  <span class="co"># this is for smooth term, e.g. s(age) in our case</span>
                          var.parametricTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"estimate"</span><span class="op">)</span>,   <span class="co"># this is for parametric term, e.g. sex in our case</span>
                          var.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adj.r.squared"</span>, <span class="st">"dev.expl"</span><span class="op">)</span>,  <span class="co"># this is for the model</span>
                        n_cores <span class="op">=</span> <span class="fl">2</span>, pbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">The formula requested: FD ~ s(age, k = 4, fx = TRUE) + sex</span> </span>
<span class="co">#&gt; <span style="color: #000000;">s(age):   k = 4;   fx = TRUE;   bs = tp (default)</span></span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span></span>
<span class="co">#&gt; Fitting element-wise GAMs for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mygam_specific</span><span class="op">)</span>
<span class="co">#&gt;   element_id s_age.p.value Intercept.estimate sexM.estimate model.adj.r.squared</span>
<span class="co">#&gt; 1          0    0.30963383           68.99361     36.640118          0.06030300</span>
<span class="co">#&gt; 2          1    0.09143477         1065.70220    -35.661635          0.06955851</span>
<span class="co">#&gt; 3          2    0.34827816           74.01208     -8.730507         -0.01092625</span>
<span class="co">#&gt; 4          3    0.48756050           62.10926     14.615306         -0.01226612</span>
<span class="co">#&gt; 5          4    0.10321419           89.36170    -15.023467          0.06031855</span>
<span class="co">#&gt; 6          5    0.13831264         1086.74460     -9.190355          0.04710121</span>
<span class="co">#&gt;   model.dev.expl</span>
<span class="co">#&gt; 1     0.13701296</span>
<span class="co">#&gt; 2     0.14551292</span>
<span class="co">#&gt; 3     0.07159834</span>
<span class="co">#&gt; 4     0.07036785</span>
<span class="co">#&gt; 5     0.13702724</span>
<span class="co">#&gt; 6     0.12488886</span></code></pre></div>
<p>You can also run p value correction. Notice that the argument names in <code>ModelArray.gam</code> are a bit different from those in <code><a href="../reference/ModelArray.lm.html">ModelArray.lm()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mygam_pValueCorrect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.gam.html">ModelArray.gam</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">modelarray</span>, phenotypes <span class="op">=</span> <span class="va">phenotypes</span>, scalar <span class="op">=</span> <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
                                      <span class="co"># we use default list of statistics output here</span>
                                      correct.p.value.smoothTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fdr"</span>,<span class="st">"bonferroni"</span><span class="op">)</span>,  <span class="co"># for smooth terms, i.e. s(age) in our case</span>
                                      correct.p.value.parametricTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bonferroni"</span><span class="op">)</span>,  <span class="co"># for parametric terms, i.e. sex (and intercept) in our case</span>
                                      <span class="co"># notice that there is no correction for model, as there is no p.value for GAM model</span>
                                      n_cores <span class="op">=</span> <span class="fl">2</span>, pbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">The formula requested: FD ~ s(age, k = 4, fx = TRUE) + sex</span> </span>
<span class="co">#&gt; <span style="color: #000000;">s(age):   k = 4;   fx = TRUE;   bs = tp (default)</span></span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span></span>
<span class="co">#&gt; Fitting element-wise GAMs for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span></code></pre></div>
<p>In addition, you can also request calculating effect size for a specific term, usually a smooth term. Effect size of a term is defined as difference between adjusted R squared of full model (formula requested) and that of reduced model (formula without the requested term).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mygam_effectSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.gam.html">ModelArray.gam</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">modelarray</span>, phenotypes <span class="op">=</span> <span class="va">phenotypes</span>, scalar <span class="op">=</span> <span class="st">"FD"</span>, element.subset <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,
                          var.smoothTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, var.parametricTerms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, var.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adj.r.squared"</span><span class="op">)</span>,  
                          eff.size.term.index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,   <span class="co"># requesting effect size for the 1st term on right hand side of formula, i.e. s(age) in this case</span>
                        n_cores <span class="op">=</span> <span class="fl">2</span>, pbar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #000000;">The formula requested: FD ~ s(age, k = 4, fx = TRUE) + sex</span> </span>
<span class="co">#&gt; <span style="color: #000000;">s(age):   k = 4;   fx = TRUE;   bs = tp (default)</span></span>
<span class="co">#&gt; <span style="color: #000000;">method: default</span></span>
<span class="co">#&gt; will get effect size (eff.size) so the execution time will be longer.</span>
<span class="co">#&gt; Fitting element-wise GAMs for FD</span>
<span class="co">#&gt; initiating....</span>
<span class="co">#&gt; looping across elements....</span>
<span class="co">#&gt; Getting the effect size: running the reduced model...</span>
<span class="co">#&gt; * Getting effect size for term: s(age, k = 4, fx = TRUE) via reduced model as below; will show up as s_age in final dataframe</span>
<span class="co">#&gt; FD ~ sex</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mygam_effectSize</span><span class="op">)</span>
<span class="co">#&gt;   element_id model.adj.r.squared s_age.eff.size</span>
<span class="co">#&gt; 1          0          0.06030300    0.013547120</span>
<span class="co">#&gt; 2          1          0.06955851    0.074849313</span>
<span class="co">#&gt; 3          2         -0.01092625    0.008018731</span>
<span class="co">#&gt; 4          3         -0.01226612   -0.011136655</span>
<span class="co">#&gt; 5          4          0.06031855    0.069442111</span>
<span class="co">#&gt; 6          5          0.04710121    0.055374767</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-the-results">Write the results<a class="anchor" aria-label="anchor" href="#write-the-results"></a>
</h3>
<p>Finally, you can write the results (data frame of statistics) back into the .h5 file.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># it's not necessary to make a copy of original .h5 file as we are doing here - you can write the results into original one. Here we make a copy only not to overwrite the example data we provide in the package.</span>
<span class="va">h5_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".h5"</span>,<span class="st">"_output.h5"</span>,<span class="va">h5_path</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span>from<span class="op">=</span><span class="va">h5_path</span>, to<span class="op">=</span><span class="va">h5_output_path</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span>, copy.mode <span class="op">=</span> <span class="cn">TRUE</span>, copy.date <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="va">modelarray_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.html">ModelArray</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="va">h5_output_path</span>, scalar_types <span class="op">=</span> <span class="st">"FD"</span><span class="op">)</span>

<span class="co"># write linear model results:</span>
<span class="fu"><a href="../reference/writeResults.html">writeResults</a></span><span class="op">(</span><span class="va">h5_output_path</span>, df.output <span class="op">=</span> <span class="va">mylm</span>,  <span class="co"># the results data.frame you got</span>
             analysis_name<span class="op">=</span><span class="st">"result_lm"</span>, <span class="co"># give the results a name - you will use this name again when converting back to .mif in ConFixel</span>
             overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># if there is an existing result with the same name in .h5, overwrite it</span>

<span class="co"># write GAM results:</span>
<span class="fu"><a href="../reference/writeResults.html">writeResults</a></span><span class="op">(</span><span class="va">h5_output_path</span>, df.output <span class="op">=</span> <span class="va">mygam_specific</span>,  
             analysis_name<span class="op">=</span><span class="st">"result_gam"</span>, 
             overwrite<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>You can reload the .h5 file and check the results:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modelarray_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelArray.html">ModelArray</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="va">h5_output_path</span>, scalar_types <span class="op">=</span> <span class="st">"FD"</span>,
                             analysis_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"result_lm"</span>, <span class="st">"result_gam"</span><span class="op">)</span><span class="op">)</span>   <span class="co"># you can load more than one result at a time</span></code></pre></div>
<p>To access the results, simply use <code>results()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">results</span><span class="op">(</span><span class="va">modelarray_new</span><span class="op">)</span><span class="op">[[</span><span class="st">"result_lm"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">results_matrix</span>
<span class="co">#&gt; &lt;100 x 13&gt; matrix of class DelayedMatrix and type "double":</span>
<span class="co">#&gt;                element_id Intercept.estimate ...  model.p.value.fdr</span>
<span class="co">#&gt;   [1,]            0.00000          163.59704   .          0.8727231</span>
<span class="co">#&gt;   [2,]            1.00000         1006.39639   .          0.9612073</span>
<span class="co">#&gt;   [3,]            2.00000          167.42774   .          0.8727231</span>
<span class="co">#&gt;   [4,]            3.00000           52.28663   .          0.9756312</span>
<span class="co">#&gt;   [5,]            4.00000          177.63929   .          0.8727231</span>
<span class="co">#&gt;    ...                  .                  .   .                  .</span>
<span class="co">#&gt;  [96,]           95.00000          125.88592   .          0.9160308</span>
<span class="co">#&gt;  [97,]           96.00000           78.22538   .          0.9756312</span>
<span class="co">#&gt;  [98,]           97.00000          181.18603   .          0.8727231</span>
<span class="co">#&gt;  [99,]           98.00000          109.03199   .          0.9227030</span>
<span class="co">#&gt; [100,]           99.00000          298.71128   .          0.8727231</span>
<span class="co">#&gt;                 model.AIC</span>
<span class="co">#&gt;   [1,]        556.9328521</span>
<span class="co">#&gt;   [2,]        595.1484727</span>
<span class="co">#&gt;   [3,]        567.6739667</span>
<span class="co">#&gt;   [4,]        541.7126248</span>
<span class="co">#&gt;   [5,]        550.9755709</span>
<span class="co">#&gt;    ...                  .</span>
<span class="co">#&gt;  [96,]        552.8348351</span>
<span class="co">#&gt;  [97,]        552.3188260</span>
<span class="co">#&gt;  [98,]        555.4548211</span>
<span class="co">#&gt;  [99,]        569.1791464</span>
<span class="co">#&gt; [100,]        616.8408020</span>
<span class="fu">results</span><span class="op">(</span><span class="va">modelarray_new</span><span class="op">)</span><span class="op">[[</span><span class="st">"result_gam"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">results_matrix</span>
<span class="co">#&gt; &lt;100 x 6&gt; matrix of class DelayedMatrix and type "double":</span>
<span class="co">#&gt;                 element_id       s_age.p.value ... model.adj.r.squared</span>
<span class="co">#&gt;   [1,]          0.00000000          0.30963383   .          0.06030300</span>
<span class="co">#&gt;   [2,]          1.00000000          0.09143477   .          0.06955851</span>
<span class="co">#&gt;   [3,]          2.00000000          0.34827816   .         -0.01092625</span>
<span class="co">#&gt;   [4,]          3.00000000          0.48756050   .         -0.01226612</span>
<span class="co">#&gt;   [5,]          4.00000000          0.10321419   .          0.06031855</span>
<span class="co">#&gt;    ...                   .                   .   .                   .</span>
<span class="co">#&gt;  [96,]         95.00000000          0.67150140   .        -0.044707964</span>
<span class="co">#&gt;  [97,]         96.00000000          0.85446801   .        -0.070146268</span>
<span class="co">#&gt;  [98,]         97.00000000          0.36294017   .        -0.010947839</span>
<span class="co">#&gt;  [99,]         98.00000000          0.37458916   .        -0.008952404</span>
<span class="co">#&gt; [100,]         99.00000000          0.08130631   .         0.068797134</span>
<span class="co">#&gt;             model.dev.expl</span>
<span class="co">#&gt;   [1,]          0.13701296</span>
<span class="co">#&gt;   [2,]          0.14551292</span>
<span class="co">#&gt;   [3,]          0.07159834</span>
<span class="co">#&gt;   [4,]          0.07036785</span>
<span class="co">#&gt;   [5,]          0.13702724</span>
<span class="co">#&gt;    ...                   .</span>
<span class="co">#&gt;  [96,]         0.040574319</span>
<span class="co">#&gt;  [97,]         0.017212611</span>
<span class="co">#&gt;  [98,]         0.071578515</span>
<span class="co">#&gt;  [99,]         0.073411057</span>
<span class="co">#&gt; [100,]         0.144813694</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
